{% load static %}

<!-- SINGLE BLOG POST STARTS -->
<section class="blog blog-inner-page">
    <div class="container">
        <div class="row">
            
            <!-- =========================================
                 COLONNE GAUCHE : CONTENU DE L'ARTICLE
            ========================================== -->
            <div class="col-12 col-lg-9 pe-3 pe-lg-5">
                <div class="blog-post-detail">
                    
                    <!-- 1. IMAGE PRINCIPALE -->
                    <div class="pic pb-4 animated" data-animation="fadeInUp" data-animation-delay="300">
                        {% if post.image %}
                            <img src="{{ post.image.url }}" class="img-fluid" alt="{{ post.title }}">
                        {% else %}
                            <!-- Image par défaut si aucune image n'est chargée -->
                            <img src="{% static 'assets/imgs/blog/big/1.jpg' %}" class="img-fluid" alt="">
                        {% endif %}
                    </div>

                    <!-- 2. TITRE -->
                    <h2 class="pt-3 pb-3 animated" data-animation="fadeInUp" data-animation-delay="400">
                        {{ post.title }}
                    </h2>

                    <!-- 3. CONTENU (TEXTE) -->
                    <!-- |linebreaks permet de garder les paragraphes -->
                    <div class="animated" data-animation="fadeInUp" data-animation-delay="500">
                        {{ post.content|linebreaks }}
                    </div>

                    <!-- NOTE : J'ai retiré la structure complexe statique (la rangée avec la 2ème image) 
                         car tout le contenu de l'article viendra de votre base de données dans la variable {{ post.content }} -->

                    <!-- 4. TAGS & PARTAGE -->
                    <div class="row pt-4 pb-4 animated" data-animation="fadeInUp" data-animation-delay="400">
                        <div class="col-12 col-lg-6">
                            <ul class="list-inline">
                                <li class="list-inline-item"><i class="las la-tags pt-2"></i></li>
                                <!-- Affiche vos tags (ex: "Web, Design") -->
                                <li class="list-inline-item">{{ post.tags_string }}</li>
                            </ul>
                        </div>
                        <div class="col-12 col-lg-6">
                            <ul class="list-inline">
                                <li class="list-inline-item"><i class="las la-share-alt"></i></li>
                                <li class="list-inline-item"><a href="#">Facebook</a></li>
                                <li class="list-inline-item"><a href="#">Twitter</a></li>
                                <li class="list-inline-item"><a href="#">Linkedin</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- 5. A PROPOS DE L'AUTEUR -->
                <div class="light-grey-bg p-4 animated" data-animation="fadeInUp" data-animation-delay="100">
                    <div class="row align-items-center">
                        <div class="col-3">
                            <img src="{% static 'assets/imgs/blog/author/author.jpg' %}" class="img-fluid" alt="...">
                        </div>
                        <div class="col-9">
                            <h3>A propos de l'auteur</h3>
                            <p>Article publié le {{ post.created_at|date:"d F Y" }} par <strong>{{ post.author_name }}</strong>.</p>
                            <p>Expert en {{ post.category_name }}.</p>
                        </div>
                    </div>
                </div>

                <!-- 6. COMMENTAIRES (Visuel statique conservé) -->
                <div class="row comments pt-5 pb-5 animated" data-animation="fadeInUp" data-animation-delay="200">
                    <div class="col-12">
                        <h3>Commentaires</h3>
                        <ul class="list-group list-group-flush">
                            <!-- Commentaire exemple -->
                            <li class="list-group-item">
                                <div class="row">
                                    <div class="col-3 col-md-2 col-lg-1 p-0">
                                        <img src="{% static 'assets/imgs/blog/comments/1.jpg' %}" class="img-fluid" alt="...">
                                    </div>
                                    <div class="col-9 col-md-10 col-lg-11 ps-4">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h4 class="mb-1">John Doe</h4>
                                            <small>2 hours ago</small>
                                        </div>
                                        <p class="mt-2">Super article, très instructif !</p>
                                        <a href="#">Répondre</a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- 7. FORMULAIRE -->
                <div class="row post-comment pb-5 animated" data-animation="fadeInUp" data-animation-delay="100">
                    <div class="col-12">
                        <h3>Laisser un commentaire</h3>
                        <div class="row g-4">
                            <div class="col-md-4">
                                <input type="text" class="form-control" id="name" placeholder="Nom">
                            </div>
                            <div class="col-md-4">
                                <input type="email" class="form-control" id="email" placeholder="Email">
                            </div>
                            <div class="col-md-12">
                                <textarea class="form-control" id="comment" placeholder="Commentaire" rows="3"></textarea>
                            </div>
                            <div class="col-md-12">
                                <button type="button" class="btn btn-primary">ENVOYER</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Fin Colonne Gauche -->


            <!-- =========================================
                 COLONNE DROITE : SIDEBAR
            ========================================== -->
            <div class="col-12 col-lg-3 sidebar pt-5 pt-lg-0">
                
                <!-- Recherche -->
                <div class="search animated" data-animation="fadeInUp" data-animation-delay="200">
                    <h2>Search</h2>
                    <div class="searchform3">
                        <form id="search3">
                            <input type="text" class="form-control s" id="s3" placeholder="Mot clé...">
                            <button type="submit" class="sbtn3"><i class="las la-search"></i></button>
                        </form>
                    </div>
                </div>

                <!-- Catégories (On affiche celle de l'article) -->
                <div class="categories animated" data-animation="fadeInUp" data-animation-delay="300">
                    <h2>Categories</h2>
                    <ul>
                        <li class="clearfix">
                            <div class="info">
                                <h2><a href="#">{{ post.category_name }}</a></h2>
                            </div>
                            <div class="posts">[Actuelle]</div>
                        </li>
                        <!-- Exemples statiques -->
                        <li class="clearfix"><div class="info"><h2><a href="#">Technology</a></h2></div></li>
                        <li class="clearfix"><div class="info"><h2><a href="#">Development</a></h2></div></li>
                    </ul>
                </div>

                <!-- Posts Tabs -->
                <div class="posts-tabs animated" data-animation="fadeInUp" data-animation-delay="100">
                    <ul class="nav" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="nav-link active" id="popular-tab" data-bs-toggle="tab" href="#popular" role="tab" aria-controls="popular" aria-selected="true">Récents</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="recent-tab" data-bs-toggle="tab" href="#recent" role="tab" aria-controls="recent" aria-selected="false">Populaire</a>
                        </li>
                    </ul>
                    
                    <div class="tab-content" id="myTabContent">
                        <!-- Onglet RÉCENTS (Dynamique) -->
                        <div class="tab-pane fade show active" id="popular" role="tabpanel" aria-labelledby="popular-tab">
                            <ul>
                                {% for recent in recent_posts %}
                                <li class="clearfix">
                                    <div class="picture">
                                        {% if recent.image %}
                                            <img src="{{ recent.image.url }}" width="72" height="72" alt="">
                                        {% else %}
                                            <img src="{% static 'assets/imgs/blog/popular-posts/1.jpg' %}" width="72" height="72" alt="">
                                        {% endif %}
                                    </div>
                                    <div class="info">
                                        <!-- Lien vers l'article -->
                                        <div class="caption">
                                            <a href="{% url 'post_detail' recent.slug %}">{{ recent.title|truncatechars:40 }}</a>
                                        </div>
                                        <div class="date">{{ recent.created_at|date:"d M, Y" }}</div>
                                    </div>
                                </li>
                                {% empty %}
                                    <li>Pas d'articles récents.</li>
                                {% endfor %}
                            </ul>
                        </div>
                        
                        <!-- Onglet POPULAIRE (Statique pour l'instant) -->
                        <div class="tab-pane fade" id="recent" role="tabpanel" aria-labelledby="recent-tab">
                            <ul>
                                <li class="clearfix">
                                    <div class="picture"><img src="{% static 'assets/imgs/blog/popular-posts/5.jpg' %}" width="72" height="72" alt="" ></div>
                                    <div class="info">
                                        <div class="caption"><a href="">Nunc molestie sapien tempor placerat ...</a></div>
                                        <div class="date">Jan 03, 2021</div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Photos (Galerie statique) -->
                <div class="photos animated" data-animation="fadeInUp" data-animation-delay="200">
                    <h2>Photos</h2>
                    <div class="row popup-gallery">
                        <div class="col-4"><a href="#"><img src="{% static 'assets/imgs/sidebar/gallery/1.jpg' %}" class="img-fluid" alt=""></a></div>
                        <div class="col-4"><a href="#"><img src="{% static 'assets/imgs/sidebar/gallery/2.jpg' %}" class="img-fluid" alt=""></a></div>
                        <div class="col-4"><a href="#"><img src="{% static 'assets/imgs/sidebar/gallery/3.jpg' %}" class="img-fluid" alt=""></a></div>
                    </div>
                </div>

                <!-- Tags (Dynamique simple) -->
                <div class="tags animated" data-animation="fadeInUp" data-animation-delay="300">
                    <h2>Tags</h2>
                    <div class="tag-list">                                        
                        <a href="#">{{ post.tags_string }}</a>
                        <!-- Tags statiques pour le remplissage -->
                        <a href="#">Design</a>
                        <a href="#">SEO</a>
                    </div>
                </div>

            </div>
            <!-- Fin Colonne Droite -->
        </div>
    </div>
</section>